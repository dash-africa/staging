{"version":3,"sources":["../server/routes.js"],"names":["routes","verifyToken","req","res","next","bearerHeader","headers","jwt","verify","process","env","SECRET_KEY","err","data","db","User","findById","user","then","status","json","message","catch","get","post","controllers","adminController","login","register","userController","loginUser","registerUser","confirmationPost","resendTokenPost","resendForgottenToken","changePassword","sendOtpToPhone","verifyPhoneNumber","getAllUsers","getUserInfo","fetchUserCart","cartController","createCart","fetchCart","addItems","categoryController","createCategory","addItem","allCategories","put","editCategory","delete","deleteCategory","removeItem","cityControler","createCity","addStore","allCities","removeStore","editCity","deleteCity","fetchCity","getAllTopCategories","itemController","create","addToCart","addAddOn","removeAddOn","fetchItem","getAll","editItem","deleteItem","storeController","createStore","allStores","editStore","deleteStore","addCategory","getStore","getCategoryItems","allCategorized","storeTypeController","all","edit","getStores","topCategoriesController","historyController","addToHistory","addOnController","allAddOns","fetchAddOn","editAddOn"],"mappings":"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","file":"routes.js","sourcesContent":["import express from 'express';\nimport jwt from 'jsonwebtoken';\nimport db from '../models';\nimport controllers from '../controllers';\n\nconst routes = express();\n\nfunction verifyToken(req, res, next) {\n    // GET THE AUTH HEADER VALUE\n    const bearerHeader = req.headers['authorization'];\n    // check if bearer is undefined\n    if (typeof bearerHeader !== 'undefined') {\n        // verify jwt\n        jwt.verify(bearerHeader, process.env.SECRET_KEY, (err, data) => {\n            db.User.findById(data.user).then((user) => {\n                if (user) {\n                    req.user = data.user;\n                    next();\n                } else {\n                    res.status(403).json({ status: false, message: 'Unauthorized' });\n                }\n            }).catch((err) => {\n                if (err) { res.status(403).json({ status: false, message: 'Unauthorized' }); }\n            });\n        });\n    } else {\n        //forbiden\n        res.status(403).json({ status: false, message: 'Unauthorized' });\n    }\n}\n\n\nroutes.get('/', (req, res) => {\n    res.json({ status: true });\n});\n\n// admin routes\nroutes.post('/admin/login', controllers.adminController.login);\nroutes.post('/admin/register', controllers.adminController.register);\n\n// user routes\nroutes.post('/user/login', controllers.userController.loginUser);\nroutes.post('/user/register', controllers.userController.registerUser);\nroutes.post('/confirmation', controllers.userController.confirmationPost);\nroutes.post('/resend', controllers.userController.resendTokenPost);\nroutes.post('/sendForget', controllers.userController.resendForgottenToken);\nroutes.post('/forgot_password', controllers.userController.changePassword);\nroutes.post('/sendOtp', verifyToken, controllers.userController.sendOtpToPhone);\nroutes.post('/verifyPhoneNumber', verifyToken, controllers.userController.verifyPhoneNumber);\nroutes.get('/user/all', controllers.userController.getAllUsers);\nroutes.post('/user/getInfo', verifyToken, controllers.userController.getUserInfo);\nroutes.get('/user/fetchCart', verifyToken, controllers.userController.fetchUserCart);\n\n// Cart Routes\nroutes.post('/cart/create', verifyToken, controllers.cartController.createCart);\nroutes.get('/cart/getCart/:id', controllers.cartController.fetchCart);\nroutes.post('/cart/addItem', controllers.cartController.addItems);\n\n// Category Routes\nroutes.post('/category/create', controllers.categoryController.createCategory);\nroutes.post('/category/addItem', controllers.categoryController.addItem);\nroutes.get('/category/all', controllers.categoryController.allCategories);\nroutes.put('/category/edit', controllers.categoryController.editCategory);\nroutes.delete('/category/delete/:id', controllers.categoryController.deleteCategory);\nroutes.post('/category/removeItem', controllers.categoryController.removeItem);\n\n// City Routes\nroutes.post('/city/create', controllers.cityControler.createCity);\nroutes.post('/city/addStore', controllers.cityControler.addStore);\nroutes.get('/city/all', controllers.cityControler.allCities);\nroutes.post('/city/removeStore', controllers.cityControler.removeStore);\nroutes.put('/city/edit', controllers.cityControler.editCity);\nroutes.delete('/city/delete/:id', controllers.cityControler.deleteCity);\nroutes.get('/city/stores/:cityId', controllers.cityControler.fetchCity);\nroutes.get('/city/topCategories/:cityId', controllers.cityControler.getAllTopCategories);\n\n// Item Routes\nroutes.post('/item/create', controllers.itemController.create);\nroutes.post('/item/addToCart', controllers.itemController.addToCart);\nroutes.post('/item/addAddOn', controllers.itemController.addAddOn);\nroutes.post('/item/removeAddOn', controllers.itemController.removeAddOn);\nroutes.get('/item/getItem/:itemId', controllers.itemController.fetchItem);\nroutes.get('/item/all', controllers.itemController.getAll);\nroutes.put('/item/edit', controllers.itemController.editItem);\nroutes.delete('/item/delete/:id', controllers.itemController.deleteItem);\n\n// Store Routes\nroutes.post('/store/create', controllers.storeController.createStore);\nroutes.get('/store/all', controllers.storeController.allStores);\nroutes.put('/store/edit', controllers.storeController.editStore);\nroutes.delete('/store/delete/:id', controllers.storeController.deleteStore);\nroutes.post('/store/addCategory', controllers.storeController.addCategory);\nroutes.get('/store/:id', controllers.storeController.getStore);\nroutes.get('/store/items/:id', controllers.storeController.getCategoryItems);\nroutes.get('/store/allCategorized/:city_id/:storeType_id', controllers.storeController.allCategorized);\n\n// Store Type Routes\nroutes.post('/storeType/create', controllers.storeTypeController.create);\nroutes.get('/storeType/all', controllers.storeTypeController.all);\nroutes.put('/storeType/edit', controllers.storeTypeController.edit);\nroutes.delete('/storeType/delete/:id', controllers.storeTypeController.delete);\nroutes.post('/storeType/addStore', controllers.storeTypeController.addStore);\nroutes.get('/storeType/getStores/:storeType_id', controllers.storeTypeController.getStores);\n\n// TopCategories Routes\nroutes.post('/top_category/create', controllers.topCategoriesController.create);\n\n// History Routes\nroutes.post('/history/add', controllers.historyController.addToHistory);\n\n// Add-On Routes\nroutes.post('/addOn/create', controllers.addOnController.create);\nroutes.post('/addOn/addItem', controllers.addOnController.addItem);\nroutes.get('/addOn/all', controllers.addOnController.allAddOns);\nroutes.get('/addOn/getAddOn/:id', controllers.addOnController.fetchAddOn);\nroutes.post('/addOn/removeItem', controllers.addOnController.removeItem);\nroutes.put('/addOn/edit', controllers.addOnController.editAddOn);\nroutes.delete('/addOn/delete/:id', controllers.addOnController.delete);\n\nexport default routes;"]}